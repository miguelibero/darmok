syntax = "proto3";

package darmok.protobuf;

import "math.proto";
import "program.proto";
import "texture.proto";

message UniformValue {
    oneof value {
        Vec4 vec4 = 1;
        Mat4 mat4 = 2;
        Mat3 mat3 = 3;
    }
}

message MaterialTexture {
    enum Type {
        BaseColor = 0;
        MetallicRoughness = 1;
        Normal = 2;
        Occlusion = 3;
        Emissive = 4;
        Specular = 5;
    }

    oneof key {
        Type type = 1;
        TextureUniformKey uniform = 2;
    }
    string texture_path = 3;
}

message Material {
    string name = 1;
    ProgramRef program = 2;
    repeated string program_defines = 3;
    
    repeated MaterialTexture textures = 4;
    map<string, UniformValue> uniform_values = 5;

    enum DepthTest {
        DepthNoTest = 0;
        DepthLess = 1;
        DepthLessEqual = 2;
        DepthEqual = 3;
        DepthGreaterEqual = 4;
        DepthGreater = 5;
        DepthNotEqual = 6;
        DepthNever = 7;
        DepthAlways = 8;
    }
    
    DepthTest depth_test = 6;

    enum OpacityType {
        Opaque = 0;
        Mask = 1;
        Transparent = 2;
    }

    OpacityType opacity_type = 7;

    enum PrimitiveType {
        Triangle = 0;
        Line = 1;
    }

    PrimitiveType primitive_type = 8;
    bool twoSided = 9;

    Color base_color = 10;
    Color3 emissive_color = 11;
    float metallic_factor = 12;
    float roughness_factor = 13;
    float normal_scale = 14;
    float occlusion_strength = 15;
    bool multiple_scattering = 16;
    float white_furnance_factor = 17;

    Color3 specular_color = 18;
    uint32 shininess = 19;
}