syntax = "proto3";

package darmok.protobuf;

import "math.proto";
import "program.proto";
import "texture.proto";

message UniformValue {
    oneof value {
        Vec4 vec4 = 1;
        Mat4 mat4 = 2;
        Mat3 mat3 = 3;
    }
}

message MaterialTexture {
    enum Type {
        BaseColor = 0;
        MetallicRoughness = 1;
        Normal = 2;
        Occlusion = 3;
        Emissive = 4;
        Specular = 5;
    }

    oneof key {
        Type type = 1;
        TextureUniformKey uniform = 2;
    }
    string texture_path = 3;
}

message Material {
    string name = 1;
    ProgramRef program = 2;
    repeated string program_defines = 3;
    
    repeated MaterialTexture textures = 4;
    map<string, UniformValue> uniform_values = 5;

    enum OpacityType {
        Opaque = 0;
        Mask = 1;
        Transparent = 2;
    }
    
    OpacityType opacity_type = 6;

    enum PrimitiveType {
        Triangle = 0;
        Line = 1;
    }

    PrimitiveType primitive_type = 7;
    bool twoSided = 8;

    Color base_color = 9;
    Color3 emissive_color = 10;
    float metallic_factor = 11;
    float roughness_factor = 12;
    float normal_scale = 13;
    float occlusion_strength = 14;
    bool multiple_scattering = 15;
    float white_furnance_factor = 16;

    Color3 specular_color = 17;
    uint32 shininess = 18;
}